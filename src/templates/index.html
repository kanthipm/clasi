{% extends "base.html" %}
{% block title %}CLASI - Course Listings{% endblock %}
{% block content %}
<style>
  form {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    align-items: center;
    margin-bottom: 1.5rem;
  }
  label {
    flex: 1 0 150px;
  }
  select, input, button {
    padding: 0.5rem;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    flex: 2 0 200px;
  }
  button {
    background-color: #007bff;
    color: #fff;
    border: none;
    cursor: pointer;
  }
  button:hover {
    background-color: #0056b3;
  }
</style>

<div class="container">
  <form id="courseForm">
    <!-- Subject Dropdown -->
    <div>
      <label for="subject">Select Subject:</label>
      <select id="subject" name="subject">
        <option value="">-- Choose a Subject --</option>
        {% for subj in subjects %}
          <option value="{{ subj }}">{{ subj }}</option>
        {% endfor %}
      </select>
    </div>
    <!-- Areas of Knowledge Dropdown -->
    <div>
      <label for="aok">Select Area of Knowledge:</label>
      <select id="aok" name="aok">
        <option value="">-- Choose AOK --</option>
        <option value="ALP">Arts, Literatures, and Performance [ALP]</option>
        <option value="CZ">Civilizations [CZ]</option>
        <option value="NS">Natural Sciences [NS]</option>
        <option value="QS">Quantitative Studies [QS]</option>
        <option value="SS">Sciences [SS]</option>
      </select>
    </div>
    <!-- Modes of Inquiry Dropdown -->
    <div>
      <label for="moi">Select Mode of Inquiry:</label>
      <select id="moi" name="moi">
        <option value="">-- Choose MOI --</option>
        <option value="CCI">Cross-Cultural Inquiry [CCI]</option>
        <option value="EI">Ethical Inquiry [EI]</option>
        <option value="STS">Science, Technology, and Society [STS]</option>
        <option value="FL">Foreign Language [FL]</option>
        <option value="R">Research [R]</option>
        <option value="W">Writing [W]</option>
      </select>
    </div>
    <!-- Professor Search -->
    <div>
      <label for="professor">Search Professor:</label>
      <input type="text" id="professor" name="professor" placeholder="Enter professor name">
    </div>
    <div>
      <button type="submit">Fetch Courses</button>
    </div>
  </form>
  <div id="results"></div>
</div>

<script>
  document.getElementById('courseForm').addEventListener('submit', function(e) {
    e.preventDefault();
    var params = new URLSearchParams(new FormData(this));
    fetch(`/courses?${params.toString()}`)
      .then(resp => resp.json())
      .then(data => {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = data.error ? `<p>Error: ${data.error}</p>` : `<pre>${JSON.stringify(data, null, 2)}</pre>`;
      })
      .catch(err => { console.error(err); alert('Error fetching courses.'); });
  });
</script>
{% endblock %}